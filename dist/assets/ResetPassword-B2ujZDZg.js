import{r as n,b,u as j,j as e,B as u}from"./index-BPKYvsHV.js";import{r as P}from"./auth.service-D-j-F9F4.js";import{L as N}from"./loader-circle-CKSZ_ffz.js";const p=s=>{const c=/[A-Z]/.test(s),a=/\d/.test(s),i=/[@#,!]/.test(s);if(s.length>=8)if(c)if(a){if(i)return!0;throw new Error("Password must contain at least one special character (@, #, !)")}else throw new Error("Password must contain at least one number");else throw new Error("Password must contain at least one uppercase letter");else throw new Error("Password must be at least 8 characters long")},k=()=>{const[s,c]=n.useState(""),[a,i]=n.useState(""),[l,d]=n.useState(!1),[m,o]=n.useState(""),[x]=b(),h=x.get("token"),w=j();n.useEffect(()=>{h||w("/signin")},[]);const f=t=>{c(t.target.value)};n.useEffect(()=>{if(!s&&!a){o(" ");return}try{if(p(s),s&&s!=a){o("Password Mismatch");return}o("")}catch(t){o(t.message)}},[s,a]);const g=async t=>{t.preventDefault(),d(!0);try{p(s)}catch(r){u.warn(r.message),d(!0);return}try{const r=await P(s,h);u.success("Password Resetted"),w("/signin")}catch(r){console.error("Failed to send password reset:",r),u.error((r==null?void 0:r.detail)||"Failed to send password reset link. Please try again.")}finally{d(!1)}};return e.jsx("div",{className:"px-4 md:px-24 pt-4 min-h-screen",children:e.jsx("div",{className:"border border-primary border-b-0 p-3 min-h-[100vh] flex justify-center items-center",children:e.jsxs("div",{className:"w-full max-w-[400px] bg-accent rounded-md p-4 md:p-8 text-white",children:[e.jsx("h1",{className:"text-2xl mb-6 text-center",children:"Reset Your Password"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",htmlFor:"email",children:"New  Password"}),e.jsx("input",{type:"password",id:"password",name:"password",value:s,onChange:f,className:"w-full p-2 rounded bg-black text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",htmlFor:"email",children:"Confirm New  Password"}),e.jsx("input",{type:"password",id:"confirm_password",name:"confirm_password",value:a,onChange:t=>i(t.target.value),className:"w-full p-2 rounded bg-black text-white",required:!0})]}),e.jsx("div",{className:"mt-2 flex items-center space-x-2",children:m&&e.jsx("p",{className:"text-red-500 text-sm",children:m})}),e.jsx("button",{type:"submit",className:"bg-primary w-full py-2 rounded text-dark mt-4 flex items-center justify-center",disabled:l||m,children:l?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"mr-2 h-4 w-4 animate-spin"}),"Resetting..."]}):"Reset Password"})]})]})})})};export{k as default};
